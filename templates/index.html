      <!DOCTYPE html>
      <html lang="en">
        <head>
          <meta charset="UTF-8" />
          <meta name="viewport" content="width=device-width, initial-scale=1.0" />
          <title>FANSHAWE</title>
          <!-- Leaflet CSS -->
          <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
          <!-- Leaflet Rotate CSS -->
          <link rel="stylesheet" href="https://unpkg.com/leaflet-rotate@0.2.8/dist/leaflet-rotate.css" />
          <!-- Distortable Image CSS -->
          <link rel="stylesheet" href="https://unpkg.com/leaflet.distortableimage@latest/dist/leaflet.distortableimage.css" />
          <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
        </head>
        <body>
          <div class="main-container">
            <div id="chat-container">
              <div id="chat-header"><img src="{{ url_for('static', filename='logo.png') }}" alt="Fanshawe College Logo"></div>
              <div id="chat-window" class="chatbox">
                <!-- Chat messages will be displayed here -->
              </div>
              <div class="chat-input">
                <input
                  type="text"
                  id="userInput"
                  placeholder="Ask about directions..."
                />
                <button id="sendButton">Send</button>
              </div>
            </div>
            <div id="map-container">
              <div id="map"></div>
              <div id="map-mode-indicator" class="mode-indicator"></div>
              <button id="reloadCoordinatesBtn" class="reload-btn" title="Reload coordinates from config file">‚ü≤ Reload Coordinates</button>
              <button id="editCoordinatesBtn" class="edit-btn" title="Edit room coordinates">‚úé Edit Coordinates</button>
              <button id="calibrateBtn" class="calibrate-btn" title="Calibrate room coordinates visually">üéØ Calibrate</button>
              <button id="showCentersBtn" class="show-centers-btn" title="Toggle room center markers on map">üëÅÔ∏è Show Centers</button>
              <button id="routeTracerBtn" class="route-tracer-btn" title="Trace routes and export as GeoJSON">üó∫Ô∏è Trace Route</button>
            </div>
          </div>
          <!-- Calibration Panel -->
          <div id="calibrationPanel" class="calibration-panel hidden">
            <div class="calibration-content">
              <div class="calibration-header">
                <h3>Calibrate Room Coordinates</h3>
                <button class="calibration-close" id="calibrationCloseBtn">&times;</button>
              </div>
              <div class="calibration-body">
                <div class="calibration-section">
                  <label for="calibrationRoomSelect">Select Room:</label>
                  <select id="calibrationRoomSelect" class="calibration-select">
                    <option value="">Choose a room to calibrate...</option>
                  </select>
                </div>

                <div id="calibrationInputs" class="calibration-inputs hidden">
                  <div class="input-group">
                    <label for="calibX">X Coordinate:</label>
                    <input type="number" id="calibX" class="calibration-input" step="0.1" placeholder="Enter X">
                  </div>
                  <div class="input-group">
                    <label for="calibY">Y Coordinate:</label>
                    <input type="number" id="calibY" class="calibration-input" step="0.1" placeholder="Enter Y">
                  </div>
                </div>

                <div id="calibrationComparison" class="calibration-comparison hidden">
                  <div class="comparison-item current">
                    <strong>Current Position</strong>
                    <div class="coord-display" id="currentCoordDisplay">-</div>
                  </div>
                  <div class="comparison-arrow">‚Üí</div>
                  <div class="comparison-item preview">
                    <strong>Preview Position</strong>
                    <div class="coord-display" id="previewCoordDisplay">-</div>
                  </div>
                </div>

                <div id="calibrationMessage" class="calibration-message"></div>
              </div>
              <div class="calibration-footer">
                <button id="cancelCalibBtn" class="btn-secondary">Cancel</button>
                <button id="confirmCalibBtn" class="btn-primary" disabled>Save Calibration</button>
              </div>
            </div>
          </div>
          <!-- Route Tracer Panel -->
          <div id="routeTracerPanel" class="route-tracer-panel hidden">
            <div class="route-tracer-content">
              <div class="route-tracer-header">
                <h3>Route Tracer</h3>
                <button class="route-tracer-close" id="routeTracerCloseBtn">&times;</button>
              </div>
              <div class="route-tracer-body">
                <div class="route-tracer-section">
                  <label for="startRoomSelect">Start Room:</label>
                  <select id="startRoomSelect" class="route-tracer-select">
                    <option value="">Choose start room...</option>
                  </select>
                </div>

                <div class="route-tracer-section">
                  <label for="endRoomSelect">End Room:</label>
                  <select id="endRoomSelect" class="route-tracer-select">
                    <option value="">Choose destination...</option>
                  </select>
                </div>

                <div id="routeStatsDisplay" class="route-stats-display hidden">
                  <div class="stat-item">
                    <span class="stat-label">Distance:</span>
                    <span class="stat-value" id="routeDistance">-</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Nodes:</span>
                    <span class="stat-value" id="routeNodes">-</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Turns:</span>
                    <span class="stat-value" id="routeTurns">-</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Rooms:</span>
                    <span class="stat-value" id="routeRooms">-</span>
                  </div>
                </div>

                <div id="routeTracerMessage" class="route-tracer-message"></div>
              </div>
              <div class="route-tracer-footer">
                <button id="clearRouteBtn" class="btn-secondary">Clear Route</button>
                <button id="calculateRouteBtn" class="btn-primary" disabled>Calculate Route</button>
                <button id="exportGeoJSONBtn" class="btn-success" disabled>Export GeoJSON</button>
              </div>
            </div>
          </div>
          <!-- Coordinate Editor Modal -->
          <div id="coordinateEditorModal" class="modal hidden">
            <div class="modal-content">
              <div class="modal-header">
                <h2>Edit Room Coordinates</h2>
                <button class="modal-close" id="modalCloseBtn">&times;</button>
              </div>
              <div class="modal-body">
                <div class="editor-controls">
                  <button id="exportJsonBtn" class="control-btn">üìã Export JSON</button>
                  <button id="importJsonBtn" class="control-btn">üì• Import JSON</button>
                  <input type="file" id="jsonFileInput" class="hidden-input" accept=".json" />
                </div>
                <div id="coordinateTableContainer" class="table-container">
                  <table id="coordinateTable" class="coordinate-table">
                    <thead>
                      <tr>
                        <th>Room ID</th>
                        <th>X Coordinate</th>
                        <th>Y Coordinate</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody id="coordinateTableBody">
                      <!-- Rows will be populated by JavaScript -->
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="modal-footer">
                <button id="cancelEditorBtn" class="btn-secondary">Cancel</button>
                <button id="saveEditorBtn" class="btn-primary">Save Changes</button>
              </div>
            </div>
          </div>
          <!-- Leaflet Scripts -->
          <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
          <script src="https://unpkg.com/leaflet-rotate@0.2.8/dist/leaflet-rotate-src.js"></script>
          <script src="https://unpkg.com/leaflet-image-transform/leaflet-image-transform.min.js"></script>
          <script src="https://unpkg.com/leaflet.distortableimage@latest/dist/leaflet.distortableimage.js"></script>
          <!-- Floor Plans Data -->
          <script src="{{ url_for('static', filename='../LeafletJS/floorPlansScript.js') }}"></script>
          <!-- Map Controller -->
          <script src="{{ url_for('static', filename='map-controller.js') }}"></script>
          <!-- Chat Script -->
          <script src="{{ url_for('static', filename='script.js') }}"></script>
        </body>
      </html>